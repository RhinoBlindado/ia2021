<?xml version="1.0" encoding="UTF-8"?>
<aiml version="2.0">
<!--
    [CASTELLANO]

    Practica 1 - Agentes Conversacionales
    Asignatura: Inteligencia Artificial 
    Autor: Valentino Lugli (Github: @RhinoBlindado)
    Fecha: Marzo, 2021
-->
<!--
    [ENGLISH]

    Practice 1 - Conversational Agents
    Course: Artificial Intelligence
    Author: Valentino Lugli (Github: @RhinoBlindado)
    Date: March, 2021
-->

<!-- NIVEL 2 -->
<!-- a. Informar del estado de un día especificado con <ESPECIFICA DIA> -->
<category>
    <pattern>LIBRE * ^</pattern>
    <template>
        <think>
            <set var="day">
                <star/>
            </set>
            <condition var="day">
                <li value="HOY">
                    <set var="completeDay">
                        <srai> DATE </srai>
                    </set>
                </li>
                <li value="MANYANA">
                    <set var="completeDay">
                        <srai> DATE IN 1 DAYS</srai>
                    </set>
                </li>
                <li value="PASADO MANYANA">
                    <set var="completeDay">
                        <srai> DATE IN 2 DAYS</srai>
                    </set>
                </li>
            </condition>

            <set var="remainder">
                <srai> REMAIN <get var="completeDay"/></srai>
            </set>
            <set var="day">
                <srai> TOP <get var="completeDay"/></srai>
            </set>
            <set var="month">
                <srai> TOP <get var="remainder"/></srai>
            </set>
            <set var="year">
                <srai> REMAIN <get var="remainder"/></srai>
            </set>
        </think>
        <srai>LIBRE <get var="day"/> de <get var="month"/> del <get var="year"/></srai>
    </template>
</category>

<category>
    <pattern>LIBRE [PROXIMO SIGUIENTE] <set>weekday_es</set> ^</pattern>
    <template>
        <think>
            <set var="completeDay">
                <srai> DATE ON <star/> </srai>
            </set>
            <set var="remainder">
                <srai> REMAIN <get var="completeDay"/></srai>
            </set>
            <set var="day">
                <srai> TOP <get var="completeDay"/></srai>
            </set>

            <set var="month">
                <srai> TOP <get var="remainder"/></srai>
            </set>
            <set var="year">
                <srai> REMAIN <get var="remainder"/></srai>
            </set>
        </think>
        <srai>LIBRE <get var="day"/> de <get var="month"/> del <get var="year"/></srai>
    </template>
</category>

<!-- b. Informar de las franjas libres en un día especificado con <ESPECIFICA DIA> -->
<category>
    <pattern>HORASLIBRES <set>todaytomorrow</set> </pattern>
    <template>
        <think>
            <set var="day">
                <star/>
            </set>
            <condition var="day">
                <li value="HOY">
                    <set var="completeDay">
                        <srai> DATE </srai>
                    </set>
                </li>                
                <li value="MANYANA">
                    <set var="completeDay">
                        <srai> DATE IN 1 DAYS</srai>
                    </set>
                </li>
                <li value="PASADO MANYANA">
                    <set var="completeDay">
                        <srai> DATE IN 2 DAYS</srai>
                    </set>
                </li>
            </condition>
            <set var="remainder">
                <srai> REMAIN <get var="completeDay"/></srai>
            </set>
            <set var="day">
                <srai> TOP <get var="completeDay"/></srai>
            </set>
            <set var="month">
                <srai> TOP <get var="remainder"/></srai>
            </set>
            <set var="year">
                <srai> REMAIN <get var="remainder"/></srai>
            </set>
        </think>
        <srai>HORASLIBRES <get var="day"/> de <get var="month"/> del <get var="year"/></srai>
    </template>
</category>

<category>
    <pattern>HORASLIBRES [PROXIMO SIGUIENTE] <set>weekday_es</set></pattern>
    <template>
        <think>
            <set var="completeDay">
                <srai> DATE ON <star/> </srai>
            </set>
            <set var="remainder">
                <srai> REMAIN <get var="completeDay"/></srai>
            </set>
            <set var="day">
                <srai> TOP <get var="completeDay"/></srai>
            </set>
            <set var="month">
                <srai> TOP <get var="remainder"/></srai>
            </set>
               <set var="year">
                <srai> REMAIN <get var="remainder"/></srai>
            </set>
        </think>
        <srai>HORASLIBRES <get var="day"/> de <get var="month"/> del <get var="year"/></srai>
    </template>
</category>

<!-- c. Informar de las franjas libres por la mañana en un día especificado con <ESPECIFICA DIA> -->
<!-- d. Informar de las franjas libres por la tarde en un día especificado con <ESPECIFICA DIA> -->
<category>
    <pattern>HORASLIBRES <set>number</set> DE <set>month_es</set> DEL <set>number</set> (POR LA) *</pattern>
    <template>
        <think>
            <set var="hourOfDay">
                <star index="4"/>
            </set>
        </think>
        <condition var="hourOfDay">
            <li value="MANYANA">
                 <srai>HLMANYANA <star/> de <star index="2"/> del <star index="3"/></srai>
            </li>
            <li value="TARDE">
                 <srai>HLTARDE <star/> de <star index="2"/> del <star index="3"/></srai>
            </li>
        </condition>
    </template>
</category>

<category>
    <pattern>HORASLIBRES <set>todaytomorrow</set> (POR LA) *</pattern>
    <template>
        <think>
            <set var="day">
                <star/>
            </set>
            <condition var="day">
                <li value="HOY">
                    <set var="completeDay">
                        <srai> DATE </srai>
                    </set>
                </li>                
                <li value="MANYANA">
                    <set var="completeDay">
                        <srai> DATE IN 1 DAYS</srai>
                    </set>
                </li>
                <li value="PASADO MANYANA">
                    <set var="completeDay">
                        <srai> DATE IN 2 DAYS</srai>
                    </set>
                </li>
            </condition>
            <set var="remainder">
                <srai> REMAIN <get var="completeDay"/></srai>
            </set>
            <set var="day">
                <srai> TOP <get var="completeDay"/></srai>
            </set>
            <set var="month">
                <srai> TOP <get var="remainder"/></srai>
            </set>
            <set var="year">
                <srai> REMAIN <get var="remainder"/></srai>
            </set>
            <set var="hourOfDay">
                <star index="2"/>
            </set>
        </think>
        <srai>HORASLIBRES <set var="day"/> DE <set var="month"/> DEL <set var="year"/> POR LA <set var="hourOfDay"/></srai>
    </template>
</category>

<category>
    <pattern>HORASLIBRES [PROXIMO SIGUIENTE] <set>weekday_es</set> (POR LA) *</pattern>
    <template>
        <think>
            <set var="completeDay">
                <srai> DATE ON <star/> </srai>
            </set>
            <set var="remainder">
                <srai> REMAIN <get var="completeDay"/></srai>
            </set>
            <set var="day">
                <srai> TOP <get var="completeDay"/></srai>
            </set>
            <set var="month">
                <srai> TOP <get var="remainder"/></srai>
            </set>
            <set var="year">
                <srai> REMAIN <get var="remainder"/></srai>
            </set>
            <set var="hourOfDay">
                <star index="2"/>
            </set>
        </think>
        <condition var="hourOfDay">
            <li value="MANYANA">
                 <srai>HLMANYANA <get var="day"/> de <get var="month"/> del <get var="year"/></srai>
            </li>
            <li value="TARDE">
                 <srai>HLTARDE <get var="day"/> de <get var="month"/> del <get var="year"/></srai>
            </li>
        </condition>
    </template>
</category>

<!-- e. Informar de las franjas libres a partir de una hora dada en un día especificado con <ESPECIFICA DIA> -->
<category>
    <pattern>HORASLIBRES <set>number</set> DE <set>month_es</set> DEL <set>number</set> A PARTIR DE LAS *</pattern>
    <template>
        <think>
            <set var="targetHour"> 
                <srai> ORDINAL <star index="4"/></srai>
            </set>

            <set var="count">
                <srai> COUNT <srai> DELETREA <star/> </srai> </srai>
            </set>

            <condition var="count">
                <li value="1">
                    <set var="day">0<star/></set>
                </li>
                <li>
                    <set var="day"><star/></set>
                </li>
            </condition>

            <set var="daySlots">
                <srai>SUBLIST FROM <get var="targetHour"/> TO 21 OF <srai>LIST OF DAY <get var="day"/>_<map name="monthStringToNumber"><star index="2"/></map>_<star index="3"/></srai></srai>
            </set>
            <set var="endOfList">0</set>
            <set var="i"><srai> MINUS <srai> MINUS <get var="targetHour"/> 1 </srai> 1 </srai> </set>
            <set var="output"></set>

            <condition var="endOfList">
                <li value="1"></li>
                <li>
                    <!-- i++; -->
                    <set var="i"><map name="successor"><get var="i"/></map></set>

                    <!-- front = daySlots.front(); -->
                    <set var="front">
                        <srai>TOP <get var="daySlots"/></srai>
                    </set>

                    <set var="count">
                        <srai>COUNT <srai> DELETREA <get var="i"/> </srai> </srai>
                    </set>

                    <condition var="count">
                        <li value="1">
                            <set var="i">0<get var="i"/></set>
                        </li>
                    </condition>

                    <!-- if(front == "LIBRE") output +=" " + i +":00";-->
                    <condition var="front">
                        <li value="LIBRE">
                            <set var="output"><get var="output"/> <get var="i"/>:00</set>
                        </li>
                    </condition>

                    <!-- daySlots.pop_front(); -->
                    <set var="daySlots">
                        <srai>REMAIN <get var="daySlots"/></srai>
                    </set>

                    <!-- if(daySlots.empty()) endOfList = 1;-->
                    <condition var="daySlots">
                        <li value="$">
                            <set var="endOfList">1</set>
                        </li>
                    </condition>
                <loop/>
                </li>
            </condition>

             <set var="isEmpty">
                <srai>COUNT <get var="output"/></srai>
            </set>

        </think>
            <condition var="isEmpty">
                <li value="0">
                    <sentence>EMPTYLIST</sentence>
                </li>
                <li><sentence><get var="output"/></sentence></li>
            </condition>
    </template>
</category>

<category>
    <pattern>HORASLIBRES <set>todaytomorrow</set> A PARTIR DE LAS *</pattern>
    <template>
        <think>
            <set var="day">
                <star/>
            </set>
            <condition var="day">
                <li value="HOY">
                    <set var="completeDay">
                        <srai> DATE </srai>
                    </set>
                </li>                
                <li value="MANYANA">
                    <set var="completeDay">
                        <srai> DATE IN 1 DAYS</srai>
                    </set>
                </li>
                <li value="PASADO MANYANA">
                    <set var="completeDay">
                        <srai> DATE IN 2 DAYS</srai>
                    </set>
                </li>
            </condition>
            <set var="hour">
                <star index="2"/>
            </set>
            <set var="remainder">
                <srai> REMAIN <get var="completeDay"/></srai>
            </set>
            <set var="day">
                <srai> TOP <get var="completeDay"/></srai>
            </set>
            <set var="month">
                <srai> TOP <get var="remainder"/></srai>
            </set>
            <set var="year">
                <srai> REMAIN <get var="remainder"/></srai>
            </set>
        </think>
        <srai>HORASLIBRES <get var="day"/> de <get var="month"/> del <get var="year"/> A PARTIR DE LAS <get var="hour"/></srai>
    </template>
</category>

<category>
    <pattern>HORASLIBRES [PROXIMO SIGUIENTE] <set>weekday_es</set> A PARTIR DE LAS *</pattern>
    <template>
        <think>
            <set var="completeDay">
                <srai> DATE ON <star/> </srai>
            </set>
            <set var="remainder">
                <srai> REMAIN <get var="completeDay"/></srai>
            </set>
            <set var="day">
                <srai> TOP <get var="completeDay"/></srai>
            </set>
            <set var="month">
                <srai> TOP <get var="remainder"/></srai>
            </set>
               <set var="year">
                <srai> REMAIN <get var="remainder"/></srai>
            </set>
            <set var="hour">
                <star index="2"/>
            </set>
        </think>
        <srai>HORASLIBRES <get var="day"/> de <get var="month"/> del <get var="year"/> A PARTIR DE LAS <get var="hour"/></srai>
    </template>
</category>

<!--    2. Reglas conversacionales -->
<!--        Pedir una cita al estilo HOY/MANYANA/PASADO MANYANA sin mas -->
<category>
    <pattern>^ cita ^ <set>todaytomorrow</set> ^</pattern>
    <template>
        <think>
            <set var="day">
                <star index="3"/>
            </set>
            <condition var="day">
                <li value="HOY">
                    <set var="completeDay">
                        <srai> DATE </srai>
                    </set>
                </li>                
                <li value="MANYANA">
                    <set var="completeDay">
                        <srai> DATE IN 1 DAYS</srai>
                    </set>
                </li>
                <li value="PASADO MANYANA">
                    <set var="completeDay">
                        <srai> DATE IN 2 DAYS</srai>
                    </set>
                </li>
            </condition>

            <set var="remainder">
                <srai> REMAIN <get var="completeDay"/></srai>
            </set>
            <set var="day">
                <srai> TOP <get var="completeDay"/></srai>
            </set>

            <set var="count">
                <srai> COUNT <srai> DELETREA <get var="day"/> </srai> </srai>
            </set>
            <condition var="count">
                <li value="1">
                    <set var="day">0<get var="day"/></set>
                </li>
            </condition>

            <set var="month">
                <srai> TOP <get var="remainder"/></srai>
            </set>
               <set var="year">
                <srai> REMAIN <get var="remainder"/></srai>
            </set>
            
            <set var="output">
                <srai> CITA <get var="day"/> de <get var="month"/> del <get var="year"/> </srai>
            </set>
        </think>
        <get var="output"/>
    </template>
</category>

<!--        Pedir una cita al estilo [PROXIMO SIGUIENTE] <dia> sin mas -->
<category>
    <pattern>^ cita ^ [PROXIMO SIGUIENTE] <set>weekday_es</set> ^</pattern>
    <template>
        <think>
            <set var="day">
                <star index="3"/>
            </set>
            <set var="completeDay">
                <srai> DATE ON <get var="day"/> </srai>
            </set>
            <set var="remainder">
                <srai> REMAIN <get var="completeDay"/></srai>
            </set>
            <set var="day">
                <srai> TOP <get var="completeDay"/></srai>
            </set>

            <set var="count">
                <srai> COUNT <srai> DELETREA <get var="day"/> </srai> </srai>
            </set>
            <condition var="count">
                <li value="1">
                    <set var="day">0<get var="day"/></set>
                </li>
            </condition>

            <set var="month">
                <srai> TOP <get var="remainder"/></srai>
            </set>
               <set var="year">
                <srai> REMAIN <get var="remainder"/></srai>
            </set>
            
            <set var="output">
                <srai> CITA <get var="day"/> de <get var="month"/> del <get var="year"/> </srai>
            </set>
        </think>
        <get var="output"/>
    </template>
</category>

<!--        Pedir una cita al estilo DD de MMMM del AA POR LA [MANYANA / TARDE] -->
<category>
    <pattern>^ cita ^ <set>number</set> de <set>month_es</set> del <set>number</set> ^ (POR LA) <set>dayphase</set> ^ </pattern>
    <template>
        <think>
            <set var="phase">
                <star index="7"/>
            </set>
            <set var="hourList">
                <srai> HORASLIBRES <star index="3"/> de <star index="4"/> del <star index="5"/> POR LA <get var="phase"/> </srai>
            </set>
            <condition var="hourList">
                <li value="EMPTYLIST">
                    <set var="output"><get var="output"/> Lo siento pero tengo toda la <get var="phase"/> ocupada. ¿Desea otro día?</set>
                </li>
                <li>
                    <set var="output">Vale,</set>
                    <set name="currentDate"><star index="3"/>_<map name="monthStringToNumber"><star index="4"/></map>_<star index="5"/></set>
                    <set name="currentDateHR"><star index="3"/> de <star index="4"/> del <star index="5"/></set>
                    <condition var="phase">
                        <li value="manyana">
                            <set var="output"><get var="output"/> <srai>MORNING ANSWERS <get var="hourList"/></srai></set>
                        </li>
                        <li value="tarde">
                            <set var="output"><get var="output"/> <srai>NOON ANSWERS <get var="hourList"/></srai></set>
                        </li>
                    </condition>
                    <set var="output"><get var="output"/> ¿Desea alguna hora en concreto?</set>
                </li>
            </condition>
        </think>
        <get var="output"/>
    </template>
</category>

<!--        Pedir una cita al estilo HOY/MANYANA/PASADO MANYANA POR LA [MANYANA / TARDE] -->
<category>
    <pattern>^ cita ^ <set>todaytomorrow</set> ^ (POR LA) <set>dayphase</set> ^ </pattern>
    <template>
        <think>
            <set var="phase">
                <star index="5"/>
            </set>
            <set var="day">
                <star index="3"/>
            </set>
            <condition var="day">
                <li value="HOY">
                    <set var="completeDay">
                        <srai> DATE </srai>
                    </set>
                </li>                
                <li value="MANYANA">
                    <set var="completeDay">
                        <srai> DATE IN 1 DAYS</srai>
                    </set>
                </li>
                <li value="PASADO MANYANA">
                    <set var="completeDay">
                        <srai> DATE IN 2 DAYS</srai>
                    </set>
                </li>
            </condition>

            <set var="remainder">
                <srai> REMAIN <get var="completeDay"/></srai>
            </set>
            <set var="day">
                <srai> TOP <get var="completeDay"/></srai>
            </set>

            <set var="count">
                <srai> COUNT <srai> DELETREA <get var="day"/> </srai> </srai>
            </set>
            <condition var="count">
                <li value="1">
                    <set var="day">0<get var="day"/></set>
                </li>
            </condition>

            <set var="month">
                <srai> TOP <get var="remainder"/></srai>
            </set>
               <set var="year">
                <srai> REMAIN <get var="remainder"/></srai>
            </set>

            <set var="output">
                <srai>CITA <get var="day"/> DE <get var="month"/> DEL <get var="year"/> POR LA <get var="phase"/></srai>
            </set>
        </think>
        <get var="output"/>
    </template>
</category>

<!--        Pedir una cita al estilo [SIGUIENTE PROXIMO] <dia> POR LA [MANYANA / TARDE] -->
<category>
    <pattern>^ cita ^ [PROXIMO SIGUIENTE] <set>weekday_es</set> ^ (POR LA) <set>dayphase</set> ^ </pattern>
    <template>
        <think>
            <set var="phase">
                <star index="5"/>
            </set>
            <set var="day">
                <star index="3"/>
            </set>
            <set var="completeDay">
                <srai> DATE ON <get var="day"/> </srai>
            </set>
            <set var="remainder">
                <srai> REMAIN <get var="completeDay"/></srai>
            </set>
            <set var="day">
                <srai> TOP <get var="completeDay"/></srai>
            </set>

            <set var="count">
                <srai> COUNT <srai> DELETREA <get var="day"/> </srai> </srai>
            </set>
            <condition var="count">
                <li value="1">
                    <set var="day">0<get var="day"/></set>
                </li>
            </condition>

            <set var="month">
                <srai> TOP <get var="remainder"/></srai>
            </set>
               <set var="year">
                <srai> REMAIN <get var="remainder"/></srai>
            </set>

            <set var="output">
                <srai>CITA <get var="day"/> DE <get var="month"/> DEL <get var="year"/> POR LA <get var="phase"/></srai>
            </set>
        </think>
        <get var="output"/>
    </template>
</category>
<!--        Pedir una cita al estilo DD de MMMM de AA A PARTIR DE LAS HH:00 -->
<!--        Pedir una cita al estilo HOY/MANYANA/PASADO MANYANA A PARTIR DE LAS HH:00 -->
<!--        Pedir una cita al estilo [SIGUIENTE PROXIMO] <dia> A PARTIR DE LAS HH:00 -->


</aiml>