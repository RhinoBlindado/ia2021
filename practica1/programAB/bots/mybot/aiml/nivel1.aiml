<?xml version="1.0" encoding="UTF-8"?>
<aiml version="2.0">
<!--
    Inteligencia Artificial 
    Practica 1
    Autor: Valentino Lugli
    Fecha: Marzo, 2021
-->

<!-- NIVEL 1 -->
<!--    1. Escribir las reglas necesarias para poder realizar las siguientes consultas dado un día representado como "dd de MMMMMMMMM del yy"-->

<!--        a. informar sobre si el día está libre o no -->
<category>
    <pattern>LIBRE * de * del *</pattern>
    <template>

        <think>
            <set var="daySlots">
                <srai>SUBLIST FROM 9 TO 21 OF <srai>LIST OF DAY <star/>_<map name="monthStringToNumber"><star index="2"/></map>_<star index="3"/></srai></srai>
            </set>

            <set var="freeSlotFound">
                <srai>FINDITEM LIBRE IN <get var="daySlots"/></srai>
            </set>
        </think>

        <condition var="freeSlotFound">
            <li value="0">NO</li>
            <li><sentence>SI</sentence></li>
        </condition>

    </template>
</category>

<!--        b. Informar de las franjas libres en un día-->
<category>
    <pattern>HORASLIBRES * de * del *</pattern>
    <template>
        <think>
            <set var="daySlots">
                <srai>SUBLIST FROM 9 TO 21 OF <srai>LIST OF DAY <star/>_<map name="monthStringToNumber"><star index="2"/></map>_<star index="3"/></srai></srai>
            </set>

            <set var="endOfList">0</set>
            <set var="output"></set>
            <set var="i">7</set>

    <!--    while(!endOfList)-->
            <condition var="endOfList">
                <li value="1"></li>
                <li>
                    <!-- i++; -->
                    <set var="i"><map name="successor"><get var="i"/></map></set>

                    <!-- front = daySlots.front(); -->
                    <set var="front">
                        <srai>TOP <get var="daySlots"/></srai>
                    </set>

                    <!-- if(front == "LIBRE") output +=" " + i +":00";-->
                    <condition var="front">
                        <li value="LIBRE">
                            <set var="output"><get var="output"/> <get var="i"/>:00</set>
                        </li>
                    </condition>

                    <!-- daySlots.pop_front(); -->
                    <set var="daySlots">
                        <srai>REMAIN <get var="daySlots"/></srai>
                    </set>

                    <!-- if(daySlots.empty()) endOfList = 1;-->
                    <condition var="daySlots">
                        <li value="$">
                            <set var="endOfList">1</set>
                        </li>
                    </condition>
                <loop/>
                </li>
            </condition>

            <set var="isEmpty">
                <srai>COUNT <get var="output"/></srai>
            </set>
        </think>
        
        <condition var="isEmpty">
            <li value="0">
                <sentence>EMPTYLIST</sentence>
            </li>
            <li><sentence><get var="output"/></sentence></li>
        </condition>

    </template>
</category>

<!--        c. Informar de las franjas libres por la mañana en un día -->
<category>
    <pattern>HLMANYANA * de * del *</pattern>
    <template>
        <think>
            <set var="daySlots">
                <srai>SUBLIST FROM 9 TO 13 OF <srai>LIST OF DAY <star/>_<map name="monthStringToNumber"><star index="2"/></map>_<star index="3"/></srai></srai>
            </set>

            <set var="endOfList">0</set>
            <set var="output"></set>
            <set var="i">7</set>

    <!--    while(!endOfList)-->
            <condition var="endOfList">
                <li value="1"></li>
                <li>
                    <!-- i++; -->
                    <set var="i"><map name="successor"><get var="i"/></map></set>

                    <!-- front = daySlots.front(); -->
                    <set var="front">
                        <srai>TOP <get var="daySlots"/></srai>
                    </set>

                    <!-- if(front == "LIBRE") output +=" " + i +":00";-->
                    <condition var="front">
                        <li value="LIBRE">
                            <set var="output"><get var="output"/> <get var="i"/>:00</set>
                        </li>
                    </condition>

                    <!-- daySlots.pop_front(); -->
                    <set var="daySlots">
                        <srai>REMAIN <get var="daySlots"/></srai>
                    </set>

                    <!-- if(daySlots.empty()) endOfList = 1;-->
                    <condition var="daySlots">
                        <li value="$">
                            <set var="endOfList">1</set>
                        </li>
                    </condition>
                <loop/>
                </li>
            </condition>

            <set var="isEmpty">
                <srai>COUNT <get var="output"/></srai>
            </set>
        </think>
        
        <condition var="isEmpty">
            <li value="0">
                <sentence>EMPTYLIST</sentence>
            </li>
            <li><sentence><get var="output"/></sentence></li>
        </condition>
    </template>
</category>

<!--        d. Informar de las franjas libres por la tarde en un día  -->
<category>
    <pattern>HLTARDE * de * del *</pattern>
    <template>
        <think>
            <set var="daySlots">
                <srai>SUBLIST FROM 14 TO 21 OF <srai>LIST OF DAY <star/>_<map name="monthStringToNumber"><star index="2"/></map>_<star index="3"/></srai></srai>
            </set>

            <set var="endOfList">0</set>
            <set var="output"></set>
            <set var="i">13</set>

    <!--    while(!endOfList)-->
            <condition var="endOfList">
                <li value="1"></li>
                <li>
                    <!-- i++; -->
                    <set var="i"><map name="successor"><get var="i"/></map></set>

                    <!-- front = daySlots.front(); -->
                    <set var="front">
                        <srai>TOP <get var="daySlots"/></srai>
                    </set>

                    <!-- if(front == "LIBRE") output +=" " + i +":00";-->
                    <condition var="front">
                        <li value="LIBRE">
                            <set var="output"><get var="output"/> <get var="i"/>:00</set>
                        </li>
                    </condition>

                    <!-- daySlots.pop_front(); -->
                    <set var="daySlots">
                        <srai>REMAIN <get var="daySlots"/></srai>
                    </set>

                    <!-- if(daySlots.empty()) endOfList = 1;-->
                    <condition var="daySlots">
                        <li value="$">
                            <set var="endOfList">1</set>
                        </li>
                    </condition>
                <loop/>
                </li>
            </condition>

            <set var="isEmpty">
                <srai>COUNT <get var="output"/></srai>
            </set>
        </think>
        
        <condition var="isEmpty">
            <li value="0">
                <sentence>EMPTYLIST</sentence>
            </li>
            <li><sentence><get var="output"/></sentence></li>
        </condition>
    </template>
</category>

<!--    2. Reglas conversacionales -->
<!--        Pedir una cita el dia DD de MMMMMM del AA-->
<category>
    <pattern>^ cita ^ <set>number</set> de <set>month_es</set> del <set>number</set> ^</pattern>
    <template>
        Entendido.
        <think>
            <set var="checkDate">
                <srai>LIBRE <star index="3"/> de <star index="4"/> del <star index="5"/></srai>
            </set>
            <set var="output"></set>
        </think>
        <condition var="checkDate">
            <li value="SI">
                <set var="morningHours">
                    <srai>HLMANYANA <star index="3"/> de <star index="4"/> del <star index="5"/></srai>
                </set>
                <set var="afterNoonHours">
                    <srai>HLTARDE <star index="3"/> de <star index="4"/> del <star index="5"/></srai>
                </set>

                <condition var="morningHours">
                    <li value="EMPTYLIST">
                        <set
                    </li>
                </condition>

            </li>
            <li>
                <sentence>No hay huecos libres en este día. ¿Desea otro dia?</sentence>
            </li>
        </condition>
    </template>
</category>
</aiml>